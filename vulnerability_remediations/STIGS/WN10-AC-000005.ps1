<#
.SYNOPSIS
    The account lockout feature, when enabled, prevents brute-force password attacks on the system. 
    This parameter specifies the amount of time that an account will remain locked after the specified number of failed logon attempts.

.NOTES
    Author          : Arthur Lau
    LinkedIn        : linkedin.com/in/arthur-lau-4a7403172/
    GitHub          : github.com/arthurlau1
    Date Created    : 2025-09-011
    Last Modified   : 2025-09-011
    Date Created    : 2024-09-09
    Last Modified   : 2024-09-09
    Version         : 1.0
    CVEs            : N/A
    Plugin IDs      : N/A
    STIG-ID         : WN10-AC-000005

.TESTED ON
    Date(s) Tested  : 
    Tested By       : 
    Systems Tested  : 
    PowerShell Ver. : 

.USAGE
    Put any usage instructions here.
    Example syntax:
     
#>

# YOUR CODE GOES HERE
# Desired minimum account lockout duration (minutes)
$desiredValue = 15

# Get current effective value
$currentValue = (net accounts | Select-String "Lockout duration").ToString().Split(":")[1].Trim().Split(" ")[0]

if ($currentValue -eq "Forever") {
    Write-Output "Compliant: Account lockout duration is set to 0 (administrator unlock required)"
}
elseif ([int]$currentValue -ge $desiredValue) {
    Write-Output "Compliant: Account lockout duration is $currentValue minutes (>= $desiredValue)"
}
else {
    Write-Output "Non-Compliant: Account lockout duration is $currentValue minutes (< $desiredValue)"
    Write-Output "Remediating to $desiredValue minutes..."
    # Apply remediation
    secedit /export /cfg C:\Windows\Temp\secpol.cfg

    (Get-Content C:\Windows\Temp\secpol.cfg) `
    -replace 'LockoutDuration = \d+', "LockoutDuration = $desiredValue" |
    Set-Content C:\Windows\Temp\secpol.cfg

    secedit /configure /db C:\Windows\security\local.sdb /cfg C:\Windows\Temp\secpol.cfg /areas SECURITYPOLICY
    gpupdate /force | Out-Null

    Write-Output "Remediated: Account lockout duration set to $desiredValue minutes"
}
